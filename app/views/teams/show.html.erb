<div class="container-fluid" data-controller='team-show'>
  <div class="team-show-container">
    <h1> <%= @team.name %></h1>
    <%# <% win_number = @past_games.first(10).select{ |game| } %>
    <%# <% lose_number = 10 - win_number %>
    <div class="day-index-container">
      <h2> Last ten games <i style="font-size:22px" class="fa-solid fa-chevron-down"></i></h2>
      <div class="team-show-games-container">
        <% @past_games.first(10).each do |game| %>
          <div class="team-show-game-card" data-action="click->team-show#launchGame"
                                           data-game-date="<%= game.date.to_date.strftime('%d %b').upcase %>"
                                           data-visitor-name="<%= game.visitor_team.name %>"
                                           data-visitor-logo="<%= game.visitor_team.logo.url %>"
                                           data-visitor-score="<%= game.visitor_team_score %>"
                                           data-home-name="<%= game.home_team.name %>"
                                           data-home-logo="<%= game.home_team.logo.url %>"
                                           data-home-score="<%= game.home_team_score %>">
            <div class="win-lose-container">
              <% if  game.win?(game,@team) %>
                  <i class="fa-solid fa-check win-game-card"></i>
              <% else %>
                  <i class="fa-solid fa-xmark lose-game-card"></i>
              <% end %>
            </div>
            <div class="team-show-game-card-date" >
              <%= game.date.to_date.strftime('%d %b').upcase %>
            </div>
            <div class="team-show-game-card-information
                        team-show-game-card-information-visitor
                        <%= 'winning-team' if game.visitor_team_score > game.home_team_score %>">
              <div>
                <%= cl_image_tag game.visitor_team.logo.key %>
                <%= game.visitor_team.name.split(' ').last %>
              </div>
              <%= game.visitor_team_score%>
            </div>
            <div class="team-show-game-card-information
                        team-show-game-card-information-home
                        <%= 'winning-team' if game.visitor_team_score < game.home_team_score %>">
              <div>
                <%= cl_image_tag game.home_team.logo.key %>
                <%= game.home_team.name.split(' ').last  %>
              </div>
              <%= game.home_team_score %>
            </div>
          </div>

          <div id='modal-game' class="modal" data-controller="modal-game" data-team-show-target='modalGame' data-backdrop="true">
              <div class="modal-dialog">
                  <div class="modal-content">
                    <div class='modal-cross-container'data-action="click->modal-game#close">
                      <i class="fas fa-times"></i>
                    </div>
                    <div class="modal-team-container">
                      <div class="modal-team-name">
                        <%= cl_image_tag game.visitor_team.logo.key, data: {modal_game_target: "visitorLogo"} %>
                        <p data-modal-game-target='visitorName'></p>
                      </div>
                      <p class='modal-team-score' data-modal-game-target='visitorScore'></p>
                      <div>
                        <p class='modal-team-separator'> - </p>
                      </div>
                      <p class='modal-team-score' data-modal-game-target='homeScore'></p>
                      <div class="modal-team-name">
                        <%= cl_image_tag game.home_team.logo.key, data: {modal_game_target: "homeLogo"} %>
                        <p data-modal-game-target='homeName'></p>
                      </div>
                    </div>

                  </div>
              </div>
          </div>

        <% end %>
      </div>
    </div>
    <div class="day-index-container">
      <h2> Players</h2>
      <div class="team-show-players-container">
        <% @players.each do |player| %>
          <div class ="team-show-players-card">
            <div class="team-show-players-card-logo-container">
              <%= cl_image_tag player.team.logo.key %>
            </div>
            <i class="fa-solid fa-user"></i>
            <h3> <%= player.first_name %> <%= player.last_name %> </h3>
            <h5>
              <% if player.position == 'C'%>
                <%= 'Center' %>
              <% elsif player.position == 'F' %>
                <%= 'Forward' %>
              <% elsif player.position == 'G' %>
                <%= 'Guard' %>
              <% else %>
                <%= player.position %>
              <% end %>
            </h5>
            <div class="team-show-players-card-description">
              <div class="team-show-players-card-stat">
                <p>Min</p>
                <p style='color:white'><%= player.average(player.stats, player)[:min] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>Points</p>
              <p style='color:white'><%= player.average(player.stats, player)[:pts] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>Assits</p>
                <p style='color:white'><%= player.average(player.stats, player)[:ast] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>Rebonds</p>
                <p style='color:white'><%= player.average(player.stats, player)[:reb] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>Blocks</p>
                <p style='color:white'><%= player.average(player.stats, player)[:blk] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>Steals</p>
                <p style='color:white'><%= player.average(player.stats, player)[:stl] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>3-pts made</p>
                <p style='color:white'><%= player.average(player.stats, player)[:fg3_made] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>Turnover</p>
                <p style='color:white'><%= player.average(player.stats, player)[:turnover] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>FG%</p>
                <p style='color:white'><%= player.average(player.stats, player)[:fg_pct] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>FG3%</p>
                <p style='color:white'><%= player.average(player.stats, player)[:fg3_pct] %></p>
              </div>
              <div class="team-show-players-card-stat">
                <p>FT%</p>
                <p style='color:white'><%= player.average(player.stats, player)[:ft_pct] %></p>
              </div>
            </div>
          </div>
        <% end %>
      </div>

    </div>
  </div>
</div>
